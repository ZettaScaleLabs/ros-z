<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Troubleshooting - ros-z Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Native Rust ROS 2 implementation using Zenoh">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../mdbook-admonish.css">
        <link rel="stylesheet" href="../book/mdbook-admonish.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ros-z Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ZettaScaleLabs/ros-z" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/ZettaScaleLabs/ros-z/edit/main/src/chapters/troubleshooting.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h1>
<p><strong>Comprehensive solutions to common ros-z build and runtime issues.</strong> This guide provides diagnostic steps, root cause analysis, and proven fixes for the most frequent problems.</p>
<div id="admonition-tip" class="admonition admonish-tip" role="note" aria-labelledby="admonition-tip-title">
<div class="admonition-title">
<div id="admonition-tip-title">
<p>Tip</p>
</div>
<a class="admonition-anchor-link" href="#admonition-tip"></a>
</div>
<div>
<p>Most issues fall into three categories: build configuration, runtime connectivity, or ROS 2 integration. Use the diagnostic flowcharts to quickly identify your issue type.</p>
</div>
</div>
<h2 id="issue-categories"><a class="header" href="#issue-categories">Issue Categories</a></h2>
<pre class="mermaid">graph TD
    A[ros-z Issue] --&gt; B{When does it occur?}
    B --&gt;|During Build| C[Build Issues]
    B --&gt;|During Runtime| D[Runtime Issues]
    B --&gt;|ROS 2 Interaction| E[Interop Issues]

    C --&gt; C1[Package Not Found]
    C --&gt; C2[Linker Errors]
    C --&gt; C3[Slow Builds]

    D --&gt; D1[No Messages]
    D --&gt; D2[Service Hangs]
    D --&gt; D3[Serialization Errors]

    E --&gt; E1[Can't Discover Nodes]
    E --&gt; E2[Message Format Errors]
</pre>
<h2 id="build-issues"><a class="header" href="#build-issues">Build Issues</a></h2>
<h3 id="cannot-find-ros-packages"><a class="header" href="#cannot-find-ros-packages">Cannot Find ROS Packages</a></h3>
<p><strong>Symptom:</strong> Build fails with "Cannot find ROS packages" or package discovery errors</p>
<p><strong>Diagnostic Steps:</strong></p>
<pre class="mermaid">flowchart TD
    A[Package Not Found] --&gt; B{Is ROS 2 sourced?}
    B --&gt;|No| C[Source ROS 2]
    B --&gt;|Yes| D{Package installed?}
    D --&gt;|No| E[Install package]
    D --&gt;|Yes| F{Environment set?}
    F --&gt;|No| G[Check env vars]
    F --&gt;|Yes| H[Clear cache &amp; rebuild]
</pre>
<p><strong>Solutions:</strong></p>
<ol>
<li>
<p><strong>Source ROS 2 environment:</strong></p>
<pre><code class="language-bash">source /opt/ros/jazzy/setup.bash
# or for rolling:
source /opt/ros/rolling/setup.bash
</code></pre>
</li>
<li>
<p><strong>Verify environment variables:</strong></p>
<pre><code class="language-bash">echo $AMENT_PREFIX_PATH
echo $CMAKE_PREFIX_PATH
</code></pre>
</li>
<li>
<p><strong>Check package installation:</strong></p>
<pre><code class="language-bash">ros2 pkg prefix example_interfaces
# If fails, install:
sudo apt install ros-jazzy-example-interfaces
</code></pre>
</li>
<li>
<p><strong>Clean and rebuild:</strong></p>
<pre><code class="language-bash">cargo clean -p ros-z-msgs
cargo build -p ros-z-msgs --features external_msgs
</code></pre>
</li>
</ol>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="#admonition-warning"></a>
</div>
<div>
<p>Always source ROS 2 before building with <code>external_msgs</code>. The build system reads environment variables at build time, not runtime.</p>
</div>
</div>
<div class="table-wrapper"><table><thead><tr><th>Error Message</th><th>Root Cause</th><th>Solution</th></tr></thead><tbody>
<tr><td>"Package X not found"</td><td>Not in search path</td><td>Source ROS 2 environment</td></tr>
<tr><td>"Cannot find ament_index"</td><td>ROS 2 not installed</td><td>Install ROS 2 or use bundled msgs</td></tr>
<tr><td>"AMENT_PREFIX_PATH not set"</td><td>Environment not sourced</td><td>Run <code>source /opt/ros/jazzy/setup.bash</code></td></tr>
</tbody></table>
</div>
<h3 id="cannot-find-crate-ros_z_msgs"><a class="header" href="#cannot-find-crate-ros_z_msgs">Cannot Find Crate <code>ros_z_msgs</code></a></h3>
<p><strong>Symptom:</strong> Compiler error "cannot find crate <code>ros_z_msgs</code>"</p>
<p><strong>Root Cause:</strong> <code>ros-z-msgs</code> is not part of default workspace members</p>
<p><strong>Solution:</strong></p>
<pre><code class="language-bash"># Build ros-z-msgs explicitly
cargo build -p ros-z-msgs

# For external messages
cargo build -p ros-z-msgs --features external_msgs

# Then build your example
cargo build --example z_srvcli --features external_msgs
</code></pre>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="#admonition-info"></a>
</div>
<div>
<p><code>ros-z-msgs</code> is excluded from default builds to avoid requiring ROS 2 for core development. Build it explicitly when needed.</p>
</div>
</div>
<h3 id="linker-errors-with-rcl"><a class="header" href="#linker-errors-with-rcl">Linker Errors with RCL</a></h3>
<p><strong>Symptom:</strong> Undefined reference errors like <code>undefined reference to rcl_init</code></p>
<p><strong>Diagnostic Flow:</strong></p>
<pre class="mermaid">sequenceDiagram
    participant C as Cargo
    participant L as Linker
    participant R as RCL Libraries

    C-&gt;&gt;L: Link rcl-z
    L-&gt;&gt;R: Find librcl.so
    alt ROS 2 Sourced
        R--&gt;&gt;L: Library found
        L--&gt;&gt;C: Link success
    else Not Sourced
        R--&gt;&gt;L: Library not found
        L--&gt;&gt;C: Undefined reference
    end
</pre>
<p><strong>Solutions:</strong></p>
<ol>
<li>
<p><strong>Source before building:</strong></p>
<pre><code class="language-bash">source /opt/ros/jazzy/setup.bash
cargo build -p rcl-z
</code></pre>
</li>
<li>
<p><strong>Verify RCL installation:</strong></p>
<pre><code class="language-bash">dpkg -l | grep ros-jazzy-rcl
# Should show: ros-jazzy-rcl, ros-jazzy-rcutils, etc.
</code></pre>
</li>
<li>
<p><strong>Custom ROS installation:</strong></p>
<pre><code class="language-bash">export CMAKE_PREFIX_PATH=/path/to/ros/install:$CMAKE_PREFIX_PATH
cargo clean -p rcl-z
cargo build -p rcl-z
</code></pre>
</li>
</ol>
<h3 id="build-takes-too-long"><a class="header" href="#build-takes-too-long">Build Takes Too Long</a></h3>
<p><strong>Symptom:</strong> Compilation is very slow, especially message generation</p>
<p><strong>Optimization Strategies:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Strategy</th><th>Command</th><th>Speedup</th></tr></thead><tbody>
<tr><td><strong>Parallel builds</strong></td><td><code>cargo build -j $(nproc)</code></td><td>2-4x</td></tr>
<tr><td><strong>Selective features</strong></td><td><code>cargo build --features std_msgs</code></td><td>5-10x</td></tr>
<tr><td><strong>Incremental compilation</strong></td><td><code>export CARGO_INCREMENTAL=1</code></td><td>2-3x</td></tr>
<tr><td><strong>Optimized profile</strong></td><td><code>cargo build --profile opt</code></td><td>Varies</td></tr>
</tbody></table>
</div>
<p><strong>Recommended approach:</strong></p>
<pre><code class="language-bash"># Build only what you need
cargo build -p ros-z-msgs --features std_msgs,geometry_msgs

# Enable sccache if available
export RUSTC_WRAPPER=sccache
cargo build
</code></pre>
<div id="admonition-tip-1" class="admonition admonish-tip" role="note" aria-labelledby="admonition-tip-1-title">
<div class="admonition-title">
<div id="admonition-tip-1-title">
<p>Tip</p>
</div>
<a class="admonition-anchor-link" href="#admonition-tip-1"></a>
</div>
<div>
<p>First build is always slow due to message generation. Subsequent builds are much faster with incremental compilation.</p>
</div>
</div>
<h2 id="runtime-issues"><a class="header" href="#runtime-issues">Runtime Issues</a></h2>
<h3 id="no-messages-received"><a class="header" href="#no-messages-received">No Messages Received</a></h3>
<p><strong>Symptom:</strong> Subscriber doesn't receive messages from publisher</p>
<p><strong>Diagnostic Checklist:</strong></p>
<pre class="mermaid">flowchart TD
    A[No Messages] --&gt; B{Both nodes running?}
    B --&gt;|No| C[Start both nodes]
    B --&gt;|Yes| D{Same topic name?}
    D --&gt;|No| E[Fix topic names]
    D --&gt;|Yes| F{QoS compatible?}
    F --&gt;|No| G[Align QoS settings]
    F --&gt;|Yes| H{Network reachable?}
    H --&gt;|No| I[Check firewall/routing]
    H --&gt;|Yes| J{Enable debug logs}
</pre>
<p><strong>Common Causes &amp; Fixes:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Issue</th><th>Diagnostic</th><th>Fix</th></tr></thead><tbody>
<tr><td><strong>Different topics</strong></td><td>Compare topic names</td><td>Use <code>--topic</code> flag consistently</td></tr>
<tr><td><strong>QoS mismatch</strong></td><td>Check QoS profiles in code</td><td>Align reliability &amp; durability</td></tr>
<tr><td><strong>Late subscription</strong></td><td>Check timing</td><td>Use transient_local durability</td></tr>
<tr><td><strong>Network isolation</strong></td><td>Try localhost first</td><td>Add explicit <code>--endpoint</code></td></tr>
</tbody></table>
</div>
<p><strong>Debug process:</strong></p>
<pre><code class="language-bash"># Terminal 1: Subscriber with debug logging
RUST_LOG=debug cargo run --example demo_nodes_listener

# Terminal 2: Publisher with debug logging
RUST_LOG=debug cargo run --example demo_nodes_talker

# Terminal 3: Zenoh session tracing
RUST_LOG=zenoh::api::session=trace cargo run --example demo_nodes_listener
</code></pre>
<p><strong>Ensure matching configuration:</strong></p>
<pre><code class="language-rust ignore">// Publisher QoS
let qos = QosProfile::default()
    .reliability(ReliabilityPolicy::Reliable)
    .durability(DurabilityPolicy::TransientLocal);

// Subscriber must match
let qos = QosProfile::default()
    .reliability(ReliabilityPolicy::Reliable)  // Must match
    .durability(DurabilityPolicy::TransientLocal);  // Must match</code></pre>
<div id="admonition-success" class="admonition admonish-success" role="note" aria-labelledby="admonition-success-title">
<div class="admonition-title">
<div id="admonition-success-title">
<p>Success</p>
</div>
<a class="admonition-anchor-link" href="#admonition-success"></a>
</div>
<div>
<p>Start both nodes on the same machine with default settings first. Add complexity incrementally once basic communication works.</p>
</div>
</div>
<h3 id="service-call-hangs"><a class="header" href="#service-call-hangs">Service Call Hangs</a></h3>
<p><strong>Symptom:</strong> Client blocks indefinitely waiting for response</p>
<p><strong>Diagnostic Sequence:</strong></p>
<pre class="mermaid">sequenceDiagram
    participant C as Client
    participant N as Network
    participant S as Server

    C-&gt;&gt;N: Send request
    Note over C: Waiting...

    alt Server Running
        N-&gt;&gt;S: Deliver request
        S-&gt;&gt;N: Send response
        N-&gt;&gt;C: Deliver response
        Note over C: Success
    else Server Not Running
        Note over C: Timeout/Hang
    end
</pre>
<p><strong>Checklist:</strong></p>
<ol>
<li>
<p><strong>Verify server is running:</strong></p>
<pre><code class="language-bash">cargo run --example demo_nodes_add_two_ints_server
# Should print: "Waiting for requests..."
</code></pre>
</li>
<li>
<p><strong>Check service names match:</strong></p>
<pre><code class="language-bash"># Enable debug logging
RUST_LOG=debug cargo run --example demo_nodes_add_two_ints_client -- --a 5 --b 3
</code></pre>
</li>
<li>
<p><strong>Add timeout to prevent infinite blocking:</strong></p>
<pre><code class="language-rust ignore">// Instead of:
let response = client.take_response()?;

// Use:
let response = client.take_response_timeout(Duration::from_secs(5))?;</code></pre>
</li>
<li>
<p><strong>Test with ROS 2 CLI if available:</strong></p>
</li>
</ol>
<pre><code class="language-bash">ros2 service list
ros2 service call /add_two_ints example_interfaces/srv/AddTwoInts "{a: 5, b: 3}"
</code></pre>
<div id="admonition-warning-1" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-1-title">
<div class="admonition-title">
<div id="admonition-warning-1-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="#admonition-warning-1"></a>
</div>
<div>
<p>Always implement timeouts for service calls. Production systems should retry with exponential backoff on timeout.</p>
</div>
</div>
<h3 id="message-serialization-errors"><a class="header" href="#message-serialization-errors">Message Serialization Errors</a></h3>
<p><strong>Symptom:</strong> "Failed to serialize/deserialize message" errors</p>
<p><strong>Root Causes:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Error</th><th>Cause</th><th>Solution</th></tr></thead><tbody>
<tr><td><strong>Version mismatch</strong></td><td>Different message versions</td><td>Rebuild all with same ros-z-msgs</td></tr>
<tr><td><strong>Type mismatch</strong></td><td>Wrong message type used</td><td>Verify type annotations</td></tr>
<tr><td><strong>Corrupted data</strong></td><td>Network or memory issue</td><td>Check network, update dependencies</td></tr>
</tbody></table>
</div>
<p><strong>Resolution steps:</strong></p>
<pre><code class="language-bash"># Clean rebuild with consistent versions
cargo clean
cargo build -p ros-z-msgs
cargo build --examples

# Verify message types match
RUST_LOG=ros_z=trace cargo run --example demo_nodes_listener
</code></pre>
<div id="admonition-note" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-title">
<div class="admonition-title">
<div id="admonition-note-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="#admonition-note"></a>
</div>
<div>
<p>CDR serialization is deterministic. If you see serialization errors, the most likely cause is type mismatches or version inconsistencies.</p>
</div>
</div>
<h2 id="ros-2-interoperability-issues"><a class="header" href="#ros-2-interoperability-issues">ROS 2 Interoperability Issues</a></h2>
<h3 id="cannot-communicate-with-ros-2-nodes"><a class="header" href="#cannot-communicate-with-ros-2-nodes">Cannot Communicate with ROS 2 Nodes</a></h3>
<p><strong>Symptom:</strong> ros-z and ROS 2 nodes can't see each other</p>
<p><strong>Architecture Requirements:</strong></p>
<pre class="mermaid">graph LR
    A[ros-z Node&lt;br/&gt;Zenoh Native] &lt;--&gt;|Zenoh| B[Zenoh Bridge]
    B &lt;--&gt;|DDS| C[ROS 2 Node&lt;br/&gt;DDS]

    A &lt;--&gt;|Zenoh| D[ROS 2 Node&lt;br/&gt;rmw_zenoh]
</pre>
<p><strong>Solution paths:</strong></p>
<h4 id="option-1-zenoh-dds-bridge"><a class="header" href="#option-1-zenoh-dds-bridge">Option 1: Zenoh-DDS Bridge</a></h4>
<pre><code class="language-bash"># Install bridge
cargo install zenoh-bridge-dds

# Run bridge
zenoh-bridge-dds

# In another terminal, run ROS 2 node
ros2 run demo_nodes_cpp talker

# In another terminal, run ros-z node
cargo run --example demo_nodes_listener
</code></pre>
<h4 id="option-2-ros-2-with-rmw_zenoh"><a class="header" href="#option-2-ros-2-with-rmw_zenoh">Option 2: ROS 2 with rmw_zenoh</a></h4>
<pre><code class="language-bash"># Install rmw_zenoh
sudo apt install ros-jazzy-rmw-zenoh-cpp

# Set RMW implementation
export RMW_IMPLEMENTATION=rmw_zenoh_cpp

# Run ROS 2 node with Zenoh
ros2 run demo_nodes_cpp talker

# Run ros-z node (no bridge needed)
cargo run --example demo_nodes_listener
</code></pre>
<div id="admonition-info-1" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-1-title">
<div class="admonition-title">
<div id="admonition-info-1-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="#admonition-info-1"></a>
</div>
<div>
<p>ros-z uses Zenoh natively. ROS 2 needs either rmw_zenoh or a Zenoh-DDS bridge to communicate with ros-z nodes.</p>
</div>
</div>
<h3 id="wrong-message-format-between-systems"><a class="header" href="#wrong-message-format-between-systems">Wrong Message Format Between Systems</a></h3>
<p><strong>Symptom:</strong> Messages corrupted when crossing ROS 2/ros-z boundary</p>
<p><strong>Verification:</strong></p>
<pre><code class="language-bash"># Test with standard messages first
cargo run --example demo_nodes_talker  # Uses std_msgs::String
ros2 topic echo /chatter               # Should display correctly

# Compare message definitions
ros2 interface show std_msgs/msg/String
</code></pre>
<p><strong>Ensure CDR compatibility:</strong></p>
<ul>
<li>ros-z uses CDR serialization by default (ROS 2 compatible)</li>
<li>Custom messages must follow ROS 2 conventions</li>
<li>Type hashes must match for interoperability</li>
</ul>
<h2 id="zenoh-configuration-issues"><a class="header" href="#zenoh-configuration-issues">Zenoh Configuration Issues</a></h2>
<h3 id="zenoh-discovery-not-working"><a class="header" href="#zenoh-discovery-not-working">Zenoh Discovery Not Working</a></h3>
<p><strong>Symptom:</strong> Nodes on different machines can't discover each other</p>
<p><strong>Network Topology Options:</strong></p>
<pre class="mermaid">graph TD
    subgraph &quot;Multicast Discovery&quot;
        A1[Node A] -.Multicast.-&gt; A2[Node B]
    end

    subgraph &quot;Router-Based&quot;
        B1[Node A] --&gt;|TCP| B3[Router]
        B2[Node B] --&gt;|TCP| B3
    end

    subgraph &quot;Peer-to-Peer&quot;
        C1[Node A] --&gt;|Direct TCP| C2[Node B]
    end
</pre>
<p><strong>Solutions by scenario:</strong></p>
<ol>
<li>
<p><strong>Same machine (should work automatically):</strong></p>
<pre><code class="language-bash"># No configuration needed
cargo run --example demo_nodes_talker
cargo run --example demo_nodes_listener
</code></pre>
</li>
<li>
<p><strong>Different machines with multicast:</strong></p>
<pre><code class="language-bash"># Check firewall allows UDP multicast
sudo ufw allow proto udp from any to 224.0.0.0/4

# Enable multicast explicitly
ZENOH_SCOUTING=multicast cargo run --example demo_nodes_talker
</code></pre>
</li>
<li>
<p><strong>Direct peer-to-peer:</strong></p>
<pre><code class="language-bash"># Machine A
cargo run --example demo_nodes_talker -- --endpoint tcp/192.168.1.100:7447

# Machine B
cargo run --example demo_nodes_listener -- --endpoint tcp/192.168.1.100:7447
</code></pre>
</li>
<li>
<p><strong>Using Zenoh router:</strong></p>
<pre><code class="language-bash"># Install router
cargo install zenohd

# Run router (on dedicated machine or one of the endpoints)
zenohd

# Connect nodes to router
cargo run --example demo_nodes_talker -- --endpoint tcp/router-ip:7447
cargo run --example demo_nodes_listener -- --endpoint tcp/router-ip:7447
</code></pre>
</li>
</ol>
<div id="admonition-tip-2" class="admonition admonish-tip" role="note" aria-labelledby="admonition-tip-2-title">
<div class="admonition-title">
<div id="admonition-tip-2-title">
<p>Tip</p>
</div>
<a class="admonition-anchor-link" href="#admonition-tip-2"></a>
</div>
<div>
<p>Start with same-machine testing, then add network complexity. Zenoh router is recommended for multi-machine deployments.</p>
</div>
</div>
<h3 id="high-latency-between-nodes"><a class="header" href="#high-latency-between-nodes">High Latency Between Nodes</a></h3>
<p><strong>Symptom:</strong> Excessive message delivery delays</p>
<p><strong>Performance Analysis:</strong></p>
<pre><code class="language-bash"># Measure baseline latency
cargo run --example z_pingpong -- --mode pong
cargo run --example z_pingpong -- --mode ping
</code></pre>
<p><strong>Optimization strategies:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Issue</th><th>Cause</th><th>Fix</th></tr></thead><tbody>
<tr><td><strong>Network latency</strong></td><td>Physical distance</td><td>Use direct connection, optimize routing</td></tr>
<tr><td><strong>Router overhead</strong></td><td>Extra hop</td><td>Connect peers directly</td></tr>
<tr><td><strong>QoS buffering</strong></td><td>Large history depth</td><td>Use <code>KeepLast(1)</code> for real-time data</td></tr>
<tr><td><strong>Reliability overhead</strong></td><td>Reliable delivery</td><td>Use <code>BestEffort</code> for sensor data</td></tr>
</tbody></table>
</div>
<p><strong>Optimized QoS for low latency:</strong></p>
<pre><code class="language-rust ignore">let qos = QosProfile::default()
    .reliability(ReliabilityPolicy::BestEffort)  // Skip retransmissions
    .history(HistoryPolicy::KeepLast(1))         // No buffering
    .durability(DurabilityPolicy::Volatile);     // No persistence</code></pre>
<h2 id="getting-help"><a class="header" href="#getting-help">Getting Help</a></h2>
<h3 id="diagnostic-information-collection"><a class="header" href="#diagnostic-information-collection">Diagnostic Information Collection</a></h3>
<p>When reporting issues, include:</p>
<pre><code class="language-bash"># System information
uname -a
rustc --version
cargo --version
ros2 --version  # if applicable

# Environment
env | grep ROS
env | grep AMENT
env | grep CMAKE

# Dependency tree
cargo tree -p ros-z-msgs

# Full debug logs
RUST_LOG=trace cargo run --example demo_nodes_talker 2&gt;&amp;1 | tee debug.log
</code></pre>
<h3 id="issue-reporting-checklist"><a class="header" href="#issue-reporting-checklist">Issue Reporting Checklist</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
ros-z version or commit hash</li>
<li><input disabled="" type="checkbox"/>
Operating system and version</li>
<li><input disabled="" type="checkbox"/>
ROS 2 distribution (if applicable)</li>
<li><input disabled="" type="checkbox"/>
Complete error message</li>
<li><input disabled="" type="checkbox"/>
Minimal reproduction steps</li>
<li><input disabled="" type="checkbox"/>
Expected vs actual behavior</li>
<li><input disabled="" type="checkbox"/>
What you've already tried</li>
</ul>
<div id="admonition-success-1" class="admonition admonish-success" role="note" aria-labelledby="admonition-success-1-title">
<div class="admonition-title">
<div id="admonition-success-1-title">
<p>Success</p>
</div>
<a class="admonition-anchor-link" href="#admonition-success-1"></a>
</div>
<div>
<p>Well-documented issues get resolved faster. Include logs, versions, and reproduction steps in your GitHub issue.</p>
</div>
</div>
<h2 id="quick-reference"><a class="header" href="#quick-reference">Quick Reference</a></h2>
<h3 id="essential-debug-commands"><a class="header" href="#essential-debug-commands">Essential Debug Commands</a></h3>
<pre><code class="language-bash"># Full trace logging
RUST_LOG=trace cargo run --example demo_nodes_talker

# Zenoh session details
RUST_LOG=zenoh::api::session=trace cargo run --example demo_nodes_listener

# Package information
cargo tree -p ros-z-msgs
ros2 pkg list | grep interfaces

# Environment check
printenv | grep -E '(ROS|AMENT|CMAKE)'
</code></pre>
<h3 id="common-fix-patterns"><a class="header" href="#common-fix-patterns">Common Fix Patterns</a></h3>
<pre><code class="language-bash"># Pattern 1: Package not found
source /opt/ros/jazzy/setup.bash
cargo clean -p ros-z-msgs
cargo build -p ros-z-msgs --features external_msgs

# Pattern 2: Connectivity issues
cargo run --example demo_nodes_talker -- --endpoint tcp/localhost:7447
cargo run --example demo_nodes_listener -- --endpoint tcp/localhost:7447

# Pattern 3: Performance problems
cargo build --release
RUST_LOG=warn cargo run --release --example demo_nodes_talker
</code></pre>
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<ul>
<li><strong><a href="./building.html">Building Guide</a></strong> - Correct build procedures</li>
<li><strong><a href="./feature_flags.html">Feature Flags</a></strong> - Available features</li>
<li><strong><a href="./examples_overview.html">Examples Overview</a></strong> - Working examples</li>
<li><strong><a href="https://github.com/ZettaScaleLabs/ros-z/issues">GitHub Issues</a></strong> - Report bugs</li>
</ul>
<p><strong>Most issues are environmental. Verify your setup matches the build scenario requirements before diving deeper.</strong></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../chapters/feature_flags.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../chapters/feature_flags.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
